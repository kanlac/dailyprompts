# Docker in Docker (DinD)

### 什么情况下需要用到 DinD？

要知道，如果直接使用 CentOS 的镜像或者 Ubuntu 的镜像，是不能使用 Docker 和 systemctl 的。

DinD，即Docker in Docker，通常发生在构建和测试包含 Docker 容器的应用程序时。比如一个发布工具。

### 为什么发布工具要做成容器？直接在 CI 环境下跑脚本不行吗？这样也就不需要用 DinD 了

1. **环境一致性**：当你将工具做成容器，你可以确保无论在哪里运行，都是在相同的环境中。这消除了"在我的机器上可以运行"这种问题。如果你直接在 CI 环境下运行脚本，你可能会遇到各种由于环境差异（例如不同的操作系统版本、系统库或其他依赖）引起的问题。
2. **易于分发和版本控制**：Docker 容器可以通过 Docker Hub 或其他容器注册表进行分发，可以为每个版本分配唯一的标签，从而方便版本控制。如果你直接在 CI 环境下运行脚本，你需要自己处理脚本的分发和版本控制。
3. **隔离和安全**：Docker 容器提供了一定级别的隔离，可以防止工具意外或恶意地影响其它部分的系统。如果你直接在 CI 环境下运行脚本，你需要小心确保脚本不会影响到 CI 环境的其他部分。
4. **便于组合和复用**：Docker 容器可以很容易地组合在一起，用来构建更复杂的系统。例如，你可以有一个包含所有依赖的基础镜像，然后在此基础上创建多个具有特定功能的工具容器。